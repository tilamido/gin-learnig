(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["bbs-topic-edit"],{"0104":function(t,n,i){var e=i("4fd8");e.__esModule&&(e=e.default),"string"===typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);var a=i("4f06").default;a("ade109e2",e,!0,{sourceMap:!1,shadowMode:!1})},"1c82":function(t,n,i){"use strict";i("7a82"),Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0,i("d3b7"),i("159b"),i("14d9"),i("a434");var e={name:"upimg-box",props:{defaultImgsList:Array,uploadUrl:{type:String,required:!0}},data:function(){return{imgsList:this.defaultImgsList}},methods:{upImg:function(){var t=this;uni.chooseImage({success:function(n){var i=n.tempFilePaths;i.forEach((function(n){uni.uploadFile({url:t.uploadUrl+"/moment/uploadfile",filePath:n,name:"file",success:function(n){var i=JSON.parse(n.data);0==i.code?(t.imgsList.push({imgurl:t.uploadUrl+i.data}),t.$emit("callParent",t.imgsList)):uni.showToast({title:"上传失败: "+i.msg,icon:"none"})},fail:function(t){console.log("上传错误信息：",t),uni.showToast({title:"上传出错",icon:"none"})}})}))}})},delImg:function(t){this.imgsList.splice(t,1)}}};n.default=e},"23e77":function(t,n,i){"use strict";i.d(n,"b",(function(){return e})),i.d(n,"c",(function(){return a})),i.d(n,"a",(function(){}));var e=function(){var t=this,n=t.$createElement,i=t._self._c||n;return t.pageLoad?i("v-uni-view",[i("v-uni-form",{on:{submit:function(n){arguments[0]=n=t.$handleEvent(n),t.formSubmit.apply(void 0,arguments)}}},[i("v-uni-input",{staticClass:"none",attrs:{type:"text",name:"_id",value:t.data._id}}),i("v-uni-view",{staticClass:"input-flex"},[i("v-uni-view",{staticClass:"input-flex-label"},[t._v("主题")]),i("v-uni-input",{staticClass:"input-flex-text",attrs:{value:t.data.title,name:"title",type:"text"}})],1),i("v-uni-view",{staticClass:"textarea-flex"},[i("v-uni-view",{staticClass:"textarea-flex-label"},[t._v("内容")]),i("v-uni-textarea",{staticClass:"textarea-flex-text",attrs:{value:t.data.content,name:"content"}})],1),i("upimg-box",{attrs:{defaultImgsList:t.data.imgList},on:{callParent:function(n){arguments[0]=n=t.$handleEvent(n),t.callImgList.apply(void 0,arguments)}}}),i("v-uni-button",{staticClass:"btn-row-submit",attrs:{"form-type":"submit"}},[t._v("发布")])],1)],1):t._e()},a=[]},2706:function(t,n,i){"use strict";i.d(n,"b",(function(){return e})),i.d(n,"c",(function(){return a})),i.d(n,"a",(function(){}));var e=function(){var t=this,n=t.$createElement,i=t._self._c||n;return i("v-uni-view",[i("v-uni-view",{staticClass:"upimg-box bg-fff"},[t._l(t.imgsList,(function(n,e){return i("v-uni-view",{key:e,staticClass:"upimg-item"},[i("v-uni-image",{staticClass:"upimg-img",attrs:{src:n.imgurl+"?x-oss-process=image/resize,m_fixed,h_100,w_100"}}),i("v-uni-view",{staticClass:"upimg-del",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.delImg(e)}}})],1)})),i("v-uni-view",{staticClass:"upimg-btn",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.upImg()}}},[i("i",{staticClass:"upimg-btn-icon"})])],2)],1)},a=[]},"28a6":function(t,n,i){"use strict";(function(t){i("7a82");var e=i("ee27").default;Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=e(i("f07e")),s=e(i("c964")),u=e(i("5f58")),r={components:{upimgBox:u.default},data:function(){return{imgsList:[],id:"",data:{},pageLoad:!1,ssuserid:""}},onLoad:function(t){this.id=t.id,this.getPage()},methods:{callImgList:function(t){this.imgsList=t},getPage:function(){var n=(0,s.default)((0,a.default)().mark((function n(){var i;return(0,a.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=this,this.ssuserid=getApp().globalData.ssuserid,this.unLogin=getApp().globalData.unLogin,""!=this.ssuserid){n.next=5;break}return n.abrupt("return",!1);case 5:t.callFunction({name:"bbs_topic",data:{cloudAction:"add",params:{ssuserid:this.ssuserid,id:this.id}}}).then((function(t){var n=t.result;if(n.error)return uni.showToast({title:n.message}),!1;i.pageLoad=!0,i.data=n.data.data[0],console.log(i.data)}));case 6:case"end":return n.stop()}}),n,this)})));return function(){return n.apply(this,arguments)}}(),formSubmit:function(n){var i=n.detail.value;i.createTime=Date.now(),i.imgList=this.imgsList,i.ssuserid=this.ssuserid,t.callFunction({name:"bbs_topic",data:{cloudAction:"save",params:i}}).then((function(t){var n=t.result;if(n.error)return uni.showToast({title:n.message}),!1;uni.showToast({title:"发布成功"}),uni.navigateBack()})).catch((function(t){console.error(t)}))}}};n.default=r}).call(this,i("a9ff")["default"])},"2fe7":function(t,n,i){"use strict";var e=i("0104"),a=i.n(e);a.a},"36f2":function(t,n,i){"use strict";i.r(n);var e=i("28a6"),a=i.n(e);for(var s in e)["default"].indexOf(s)<0&&function(t){i.d(n,t,(function(){return e[t]}))}(s);n["default"]=a.a},"4fd8":function(t,n,i){var e=i("24fb");n=e(!1),n.push([t.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* 样式保持不变 */",""]),t.exports=n},"5f58":function(t,n,i){"use strict";i.r(n);var e=i("2706"),a=i("8b1a");for(var s in a)["default"].indexOf(s)<0&&function(t){i.d(n,t,(function(){return a[t]}))}(s);i("2fe7");var u=i("f0c5"),r=Object(u["a"])(a["default"],e["b"],e["c"],!1,null,"2d8c8670",null,!1,e["a"],void 0);n["default"]=r.exports},"8b1a":function(t,n,i){"use strict";i.r(n);var e=i("1c82"),a=i.n(e);for(var s in e)["default"].indexOf(s)<0&&function(t){i.d(n,t,(function(){return e[t]}))}(s);n["default"]=a.a},b5b3:function(t,n,i){"use strict";i.r(n);var e=i("23e77"),a=i("36f2");for(var s in a)["default"].indexOf(s)<0&&function(t){i.d(n,t,(function(){return a[t]}))}(s);var u=i("f0c5"),r=Object(u["a"])(a["default"],e["b"],e["c"],!1,null,"6e9aa2d6",null,!1,e["a"],void 0);n["default"]=r.exports}}]);